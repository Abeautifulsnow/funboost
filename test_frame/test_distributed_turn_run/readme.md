
## 使用单个机器模拟实现用户的如下奇葩特殊需求


```
现在是在单台机器模拟实现  "两个机器轮流运行消息,并且同时只有一台机器在执行消息,同时只有一个消息被执行,不允许并发运行消息 " 这个需求.

实际上是动态自动获取当前机器ip,不需要 run_execute_msg_on_host101.py run_execute_msg_on_host102.py 两个重复的文件

```

## 用户实际例子是 ,利用多台物理机ip反爬虫
```
该用户不使用ip代理池,用户希望轮流使用多台机器请求url,同时保证多台机器只有一个机器在运行爬取url,避免触发ip反爬虫
```

## 难点和解决方式
```
难点:
要实现多台物理机只有一台在进行爬取url,这个使用redis 分布式锁就可以保证了.

解决方式:
要保证每台机器轮流爬一个url,那就不光是分布式锁就能解决了
所以使用单线程并发模式 + 分发到不同的ip队列,使用rpc阻塞机器运行爬虫获取函数的返回值,
这样就能达到多台机器只有一个机器在运行,并保证每台机器轮流爬虫
```

## 脚本说明
```
run_distribute_msg.py 是 从queue1 获取消息,并轮流分发到 queue2的各个ip对应的队列名字

run_execute_msg_on_host101.py 和 run_execute_msg_on_host102.py 是为了方便单台机器模拟在两台机器上运行,
实际不需要重复的写这两个文件.
```